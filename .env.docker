# ================================
# Docker Compose 环境变量配置文件
# ================================
# 使用方法：
# 1. 复制此文件并重命名为 .env
# 2. 根据实际生产环境修改下面的配置值
# 3. 运行 docker-compose up -d 启动服务

# ========================================
# MySQL 数据库配置
# ========================================
# MySQL 根密码（生产环境必须修改为强密码）
# 生成强密码命令：openssl rand -base64 32
MYSQL_ROOT_PASSWORD=your_secure_mysql_password_change_me

# MySQL 数据库名称
MYSQL_DATABASE=websocket_relay

# ========================================
# JWT 认证配置
# ========================================
# JWT 密钥（生产环境必须修改为强随机密钥）
# 生成方法：node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=your-super-secret-jwt-key-change-in-production-at-least-32-characters

# JWT 过期时间（示例: 7d=7天, 24h=24小时, 60m=60分钟）
JWT_EXPIRES_IN=7d

# ========================================
# CORS 跨域配置
# ========================================
# 允许的前端域名（多个域名用逗号分隔）
# 生产环境示例：https://example.com,https://www.example.com
ALLOWED_ORIGINS=http://localhost,http://localhost:80

# ========================================
# 前端环境变量
# ========================================
# 前端访问端口（宿主机端口）
FRONTEND_PORT=80

# API 访问路径（相对路径，由 Nginx 反向代理）
VITE_API_URL=/api

# WebSocket 连接地址
# 本地开发：ws://localhost/ws
# 生产环境（HTTP）：ws://your-domain.com/ws
# 生产环境（HTTPS）：wss://your-domain.com/ws
VITE_WS_URL=ws://localhost/ws

# ========================================
# 日志配置
# ========================================
# 日志级别: error, warn, info, http, verbose, debug, silly
# 生产环境建议使用 info 或 warn
LOG_LEVEL=info

# ========================================
# 性能优化配置
# ========================================
# 统计数据批量更新间隔（毫秒）
STATS_BATCH_INTERVAL=5000

# 统计数据批量更新阈值
STATS_BATCH_SIZE=100

# ========================================
# 生产环境注意事项
# ========================================
# 1. 【必须】修改 MYSQL_ROOT_PASSWORD 为强密码
# 2. 【必须】修改 JWT_SECRET 为强随机密钥（至少 32 字符）
# 3. 【必须】修改 ALLOWED_ORIGINS 为实际的生产域名
# 4. 【必须】修改 VITE_WS_URL 为实际的生产 WebSocket 地址
# 5. 【推荐】设置 LOG_LEVEL 为 info 或 warn
# 6. 【推荐】使用 HTTPS/WSS 协议（需要配置 SSL 证书）
# 7. 【推荐】定期备份 MySQL 数据（docker volume: mysql_data）

# ========================================
# SSL/HTTPS 配置（可选，需要 Nginx 额外配置）
# ========================================
# 如果使用 HTTPS，需要：
# 1. 准备 SSL 证书文件（.crt 和 .key）
# 2. 修改 docker/nginx/default.conf 添加 SSL 配置
# 3. 修改 VITE_WS_URL 使用 wss:// 协议
# 4. 修改 ALLOWED_ORIGINS 使用 https:// 协议
