# WebSocket Relay Platform 用户使用说明

欢迎使用 WebSocket Relay Platform！本文档面向使用网页界面管理端点的用户,帮助您快速了解平台功能。

---

## 快速开始

只需 3 步,5 分钟即可完成配置:

### 步骤 1: 注册并登录

1. 访问平台首页
2. 点击"注册"按钮
3. 填写用户名和密码完成注册
4. 使用注册的账号登录系统

**注意:** 如果平台开启了邀请码功能,您需要在注册时输入有效的邀请码。

### 步骤 2: 创建端点

1. 登录后进入 Dashboard (控制台)
2. 点击右上角的"创建端点"按钮
3. 输入端点名称(例如: "聊天室端点"、"游戏服务器")
4. 点击"确定"完成创建

创建成功后,系统会为您生成:
- **端点 ID**: 唯一标识符,用于连接 WebSocket
- **WebSocket URL**: 完整的连接地址,可直接复制使用

### 步骤 3: 查看端点详情

1. 在 Dashboard 中点击端点卡片
2. 进入端点详情页查看:
   - 端点基本信息
   - 实时统计数据
   - 连接设备列表
   - WebSocket URL (可点击复制按钮一键复制)

---

## 平台功能介绍

### 1. 端点管理

#### 什么是端点?

端点 (Endpoint) 是消息中继的通道。同一个端点下的所有客户端可以互相通信,不同端点之间完全隔离。

**典型使用场景:**
- **聊天室**: 每个聊天室创建一个端点,房间内成员互相通信
- **多人游戏**: 每个游戏房间对应一个端点,实现玩家间实时交互
- **协作工具**: 团队协作项目创建端点,成员实时同步数据
- **IoT 设备**: 每个设备组创建端点,设备间消息推送

#### 端点操作

**创建端点:**
1. 进入 Dashboard 页面
2. 点击右上角"创建端点"按钮
3. 输入端点名称
4. 点击"确定"

**查看端点详情:**
1. 在 Dashboard 中找到您的端点卡片
2. 点击卡片进入详情页
3. 查看端点信息、统计数据、连接设备

**复制 WebSocket URL:**
1. 进入端点详情页
2. 在"端点详情"卡片中找到"WebSocket URL"字段
3. 点击右侧的"复制"按钮
4. URL 已复制到剪贴板,可粘贴给开发者使用

**删除端点:**
1. 进入端点详情页
2. 点击右上角的"删除端点"按钮
3. 确认删除操作

**注意:** 删除端点是永久性操作,所有相关数据将被删除,请谨慎操作!

### 2. 实时统计

在端点详情页的"实时统计"卡片中,您可以查看以下数据:

- **当前连接数**: 实时显示有多少客户端当前连接到此端点
- **历史总连接数**: 自创建以来的累计连接次数
- **总消息数**: 通过此端点中继的消息总数

统计数据会自动刷新,帮助您实时监控端点使用情况。

### 3. 设备管理

在端点详情页的"连接设备"卡片中,您可以:

**查看设备列表:**
- 查看所有连接过的设备
- 查看设备的在线状态(绿色徽章表示在线,灰色徽章表示离线)
- 查看设备的最后连接时间

**编辑设备名称:**
1. 在设备列表中找到要编辑的设备
2. 点击设备名称右侧的"编辑"按钮
3. 输入新的设备名称
4. 点击"保存"

**在线状态判断规则:**
- 设备在 30 秒内有连接活动视为在线
- 超过 30 秒无活动视为离线
- 设备列表会自动刷新

---

## 管理员功能

如果您是平台管理员,您将拥有以下额外功能:

### 1. 邀请码管理

管理员可以生成、查看和导出邀请码。

**访问邀请码管理页面:**
1. 点击顶部导航栏的"管理"菜单
2. 选择"邀请码管理"

**生成邀请码:**
1. 点击右上角"生成邀请码"按钮
2. 输入邀请码数量(1-100)
3. 点击"确定"
4. 系统会自动生成指定数量的邀请码

**查看邀请码列表:**
- 邀请码列表显示所有生成的邀请码
- 可查看邀请码的使用状态(已使用/未使用)
- 可查看邀请码的创建时间和使用时间

**导出邀请码:**
1. 点击右上角的"导出"按钮
2. 选择导出格式(CSV 或 JSON)
3. 文件会自动下载到本地

### 2. 用户管理

管理员可以查看所有用户和他们的端点。

**访问用户管理页面:**
1. 点击顶部导航栏的"管理"菜单
2. 选择"用户管理"

**查看用户列表:**
- 用户列表显示所有注册用户
- 可查看用户的管理员状态
- 可查看用户的注册时间
- 可查看用户的端点数量

**查看用户的端点:**
1. 在用户列表中找到目标用户
2. 点击用户端点数量列的"查看端点"链接
3. 进入用户端点列表页面,查看该用户的所有端点

---

## 基本概念

### 端点隔离

不同端点之间的消息**完全隔离**:
- 端点 A 的客户端无法收到端点 B 的消息
- 每个端点都是独立的通信通道
- 您可以为不同的应用场景创建多个端点

### WebSocket URL

WebSocket URL 是客户端连接到端点的地址,格式如下:

```
ws://域名:端口/ws/{端点ID}
```

或者(生产环境,使用 SSL 加密):

```
wss://域名/ws/{端点ID}
```

**如何使用:**
1. 在端点详情页复制 WebSocket URL
2. 将 URL 提供给开发者
3. 开发者使用此 URL 连接到端点

**注意:** WebSocket URL 包含端点 ID,不同端点的 URL 是不同的。

### 消息中继机制

WebSocket Relay Platform 采用**广播模式**中继消息:

1. 客户端 A 连接到端点并发送消息
2. 平台将消息转发给**同一端点**下的所有其他客户端 (B, C, D...)
3. 发送者 A **不会收到**自己发送的消息(不回显)

**这意味着:**
- 如果端点有 10 个连接的客户端,其中 1 个发送消息,其他 9 个客户端会收到
- 发送者自己不会收到自己的消息(如需显示,由客户端本地处理)

---

## 常见问题 FAQ

### 1. 如何修改端点名称?

目前平台不支持修改端点名称。如需更改,建议:
1. 创建一个新的端点,使用新名称
2. 将客户端迁移到新端点
3. 删除旧端点

### 2. 如何删除端点?

1. 进入端点详情页
2. 点击右上角的"删除端点"按钮
3. 在确认对话框中点击"确定"

**注意:** 删除操作是永久性的,无法恢复!

### 3. 如何查看端点的历史消息?

目前平台不支持查看历史消息。WebSocket Relay Platform 是一个**实时消息中继服务**,不存储任何消息内容。

如果您需要查看历史消息,建议:
- 在客户端应用中实现消息存储功能
- 使用数据库或本地存储保存消息记录

### 4. 端点可以创建多少个?

目前平台对端点数量没有限制。您可以根据实际需求创建任意数量的端点。

### 5. 如何邀请其他用户注册? (管理员)

如果您是管理员:
1. 进入"管理" → "邀请码管理"页面
2. 点击"生成邀请码"按钮生成新的邀请码
3. 复制邀请码并分享给新用户
4. 新用户在注册时输入邀请码即可完成注册

### 6. 如何查看所有用户的端点? (管理员)

如果您是管理员:
1. 进入"管理" → "用户管理"页面
2. 查看用户列表中的"端点数量"列
3. 点击端点数量链接查看该用户的所有端点

### 7. 设备名称是如何生成的?

设备名称由客户端应用在连接时提供。如果客户端未提供设备名称,系统会自动生成默认名称(格式: "设备-{前4位ID}")。

您可以在端点详情页的"连接设备"卡片中编辑设备名称。

### 8. 为什么设备显示为离线?

设备在 30 秒内有连接活动视为在线,超过 30 秒无活动视为离线。

可能的原因:
- 客户端已关闭连接
- 客户端网络中断
- 客户端应用崩溃
- 服务器暂时无法与客户端通信

### 9. 如何保证消息安全?

平台本身提供以下安全机制:
- 用户认证(需要登录才能创建端点)
- 端点隔离(不同端点之间消息完全隔离)
- JWT Token 认证(API 调用需要有效的 Token)

如需更高级的安全保护,建议:
- 在客户端应用中实现消息加密
- 验证消息来源和格式
- 使用 HTTPS/WSS 加密连接(生产环境)

---

## 技术支持

如果您在使用过程中遇到问题,请:

1. 查看本文档的"常见问题 FAQ"章节
2. 检查端点状态和统计数据
3. 联系技术支持: support@example.com

---

**祝您使用愉快! 🎉**
