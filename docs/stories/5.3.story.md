# Story 5.3: 用户管理页面 UI 优化

## Status

**Done**

## Story

**As a** 管理员，
**I want** 用户管理页面提供更强大和便捷的管理功能，
**so that** 我可以快速过滤和定位目标用户，高效查看用户详情和端点信息，而不需要频繁跳转页面。

## Acceptance Criteria

1. **多条件过滤功能**：
   - 页面顶部添加过滤器组（角色过滤 + 端点数量范围过滤）
   - 角色过滤支持：全部/管理员/普通用户
   - 端点数量范围过滤支持：全部/无端点(0)/有端点(>0)/多端点(≥3)
   - 过滤器变更时自动更新表格数据
   - 搜索与过滤可同时生效

2. **优化端点数量列交互**：
   - 点击端点数量后弹出 Drawer（抽屉组件），而非跳转页面
   - Drawer 顶部显示用户信息卡片（用户名、邮箱、角色、注册时间）
   - Drawer 下方显示该用户的所有端点列表（复用表格组件）
   - Drawer 支持关闭按钮和遮罩层点击关闭

3. **表格排序增强**：
   - 表格支持按"注册时间"和"端点数量"排序
   - 默认按注册时间降序排列（最新用户在前）
   - 点击列标题切换升序/降序

4. **用户详情快速预览**：
   - 用户名列添加 Popover 快速预览（鼠标悬停）
   - Popover 显示：用户名、邮箱、角色、注册时间、端点数量
   - Popover 内容清晰美观，使用 Descriptions 组件展示

5. **视觉增强和交互优化**：
   - 优化页面整体布局（添加卡片容器、合理间距）
   - 过滤器使用响应式布局（桌面端并排，移动端堆叠）
   - 表格添加 hover 效果和圆角边框
   - 空状态优化（添加友好的图标和提示文案）
   - 使用 Ant Design 5.x 的现代化设计风格（纯色背景、无渐变、无 emoji）

## Tasks / Subtasks

- [ ] **Task 1: 实现多条件过滤功能** (AC: 1)
  - [ ] 添加 `roleFilter` 状态变量（类型：'all' | 'admin' | 'user'，默认 'all'）
  - [ ] 添加 `endpointCountFilter` 状态变量（类型：'all' | 'none' | 'any' | 'multiple'，默认 'all'）
  - [ ] 创建过滤器 UI 组件（使用 Row + Col 布局，包含两个 Segmented 组件）
  - [ ] 实现 `getFilteredUsers` 辅助函数：
    - 根据 `roleFilter` 过滤用户角色（admin: `is_admin === true`, user: `is_admin === false`）
    - 根据 `endpointCountFilter` 过滤端点数量（none: `=== 0`, any: `> 0`, multiple: `>= 3`）
    - 搜索与过滤同时生效（先过滤，再搜索）
  - [ ] 将 Table 的 `dataSource` 改为 `getFilteredUsers()` 返回值
  - [ ] 测试过滤功能的正确性

- [ ] **Task 2: 优化端点数量列交互（Drawer 实现）** (AC: 2)
  - [ ] 添加 `drawerVisible` 状态变量（类型：boolean，默认 false）
  - [ ] 添加 `selectedUser` 状态变量（类型：UserListItem | null，默认 null）
  - [ ] 修改 `handleViewUserEndpoints` 函数：
    - 不再跳转页面，改为设置 `selectedUser` 和打开 Drawer
    - 设置 `drawerVisible = true`
  - [ ] 创建 Drawer 组件（`width={640}`，`placement="right"`）
  - [ ] Drawer 内部实现：
    - 顶部：用户信息卡片（使用 Card + Descriptions 组件）
    - 中间：端点列表标题
    - 下方：端点列表（需要调用 API 获取该用户的端点数据）
  - [ ] 实现 `fetchUserEndpoints` 函数：
    - 调用 `getUserEndpoints(userId)` API（需确认 API 是否存在，或复用 `/api/endpoints?userId=xxx`）
    - 加载端点数据到 Drawer 内的表格
  - [ ] 添加关闭 Drawer 的逻辑（关闭按钮、遮罩层点击）
  - [ ] 测试 Drawer 打开/关闭和数据加载

- [ ] **Task 3: 实现表格排序增强** (AC: 3)
  - [ ] 为"注册时间"列添加 `sorter` 属性（比较 `created_at` 时间戳）
  - [ ] 为"端点数量"列添加 `sorter` 属性（比较 `endpoint_count` 数值）
  - [ ] 设置"注册时间"列的默认排序：降序（`defaultSortOrder: 'descend'`）
  - [ ] 测试排序功能（点击列标题，验证升序/降序切换）

- [ ] **Task 4: 实现用户详情快速预览（Popover）** (AC: 4)
  - [ ] 创建 `renderUserPopover` 辅助函数：
    - 接收 `UserListItem` 参数
    - 返回 Popover 组件包裹的用户名文本
    - Popover 内容使用 Descriptions 组件展示用户详情
  - [ ] 更新"用户名"列的 `render` 函数：
    - 调用 `renderUserPopover` 渲染用户名和 Popover
  - [ ] 测试 Popover 悬停显示效果

- [ ] **Task 5: 视觉增强和交互优化** (AC: 5)
  - [ ] **页面整体布局优化**：
    - 为页面主容器添加背景色（浅灰色纯色背景，如 `#f5f5f5`）
    - 使用 Card 组件包裹过滤区域和表格区域
    - 调整页面最大宽度和居中对齐（`maxWidth: 1400px, margin: 0 auto`）
  - [ ] **过滤器布局**：
    - 使用 Row 和 Col 组件创建响应式布局
    - 桌面端（≥768px）：搜索框和两个过滤器并排显示
    - 移动端（<768px）：搜索框和过滤器堆叠显示
    - 添加合理的间距（`gutter={[16, 16]}`）
  - [ ] **表格样式美化**：
    - 添加圆角边框（`style={{ borderRadius: '12px', overflow: 'hidden' }}`）
    - 添加 hover 效果（通过全局样式或 CSS Modules）
    - 优化表头样式（加粗字体、背景色区分）
  - [ ] **空状态优化**：
    - 添加友好的空状态图标（如 TeamOutlined）
    - 优化提示文案："还没有用户数据"
  - [ ] **禁止项检查**：
    - 检查并移除所有渐变色彩
    - 检查并移除所有 emoji（图标使用 Ant Design Icons）

- [ ] **Task 6: 代码质量和测试** (AC: 所有)
  - [ ] 运行 ESLint 和 Prettier，确保代码风格一致
  - [ ] 检查 TypeScript 类型安全，修复所有类型错误
  - [ ] 手动测试所有新增功能：
    - 角色过滤（全部/管理员/普通用户）
    - 端点数量范围过滤（全部/无端点/有端点/多端点）
    - 端点数量 Drawer 展开和关闭
    - 用户详情 Popover 悬停显示
    - 表格排序（注册时间、端点数量）
  - [ ] 测试搜索和过滤的组合效果
  - [ ] 测试不同用户数量场景（0个、1个、10个、50+个）
  - [ ] 测试不同屏幕尺寸（桌面、平板、手机）
  - [ ] 验证现有用户管理功能不受影响（回归测试）

## Dev Notes

### 前置故事关键洞察

**当前 UsersPage 实现概述：** [Source: packages/frontend/src/pages/admin/UsersPage.tsx]

- ✅ 基础功能已实现：用户列表展示、搜索功能、角色显示（Badge）、端点数量显示
- ✅ 使用 Ant Design Table 组件展示数据，列配置清晰
- ✅ 使用 Input.Search 实现用户名搜索
- ✅ 端点数量列可点击，当前跳转到 Dashboard 并传递 `userId` 参数
- ✅ 表格支持按用户名和注册时间排序
- ⚠️ **缺少功能**：多条件过滤、Drawer 查看端点、Popover 预览、端点数量排序

**关键改进方向：**

1. **多条件过滤**：需要添加角色过滤器和端点数量范围过滤器 UI，实现组合过滤逻辑
2. **Drawer 优化**：端点数量点击后不再跳转，改为弹出 Drawer 展示用户信息和端点列表
3. **Popover 预览**：用户名列添加 Popover，鼠标悬停显示完整用户信息
4. **排序增强**：为端点数量列添加排序功能

---

### 技术栈和依赖

[Source: docs/architecture/tech-stack.md]

| 技术 | 版本 | 用途 | 备注 |
|------|------|------|------|
| **React** | 18.2+ | UI 框架 | 使用 Hooks（`useState`, `useEffect`） |
| **TypeScript** | 5.3+ | 类型安全 | 严格模式，所有变量需类型定义 |
| **Ant Design** | 5.x | UI 组件库 | 使用 `Table`, `Drawer`, `Popover`, `Segmented`, `Descriptions`, `Row`, `Col` |
| **date-fns** | 3.x | 日期处理 | 使用 `format` 格式化日期 |
| **react-router-dom** | 6.x | 路由管理 | 使用 `useNavigate`（当前实现，本故事将移除跳转逻辑） |

**不需要新增依赖：** 所有功能使用现有技术栈即可实现

---

### 前端架构和文件结构

[Source: docs/architecture/frontend-architecture.md]

**UsersPage 文件位置：**
```
packages/frontend/src/pages/admin/UsersPage.tsx
```

**关联服务层：**
```
packages/frontend/src/services/admin.service.ts
```

**相关类型定义：**
```
packages/shared/src/types/user.types.ts
```

**关键架构原则：** [Source: docs/architecture/coding-standards.md#critical-fullstack-rules]

- ✅ **API Calls:** 前端必须通过 `services/` 层调用 API，禁止直接使用 Axios
- ✅ **State Updates:** 禁止直接修改状态，使用 `setState`
- ✅ **Type Sharing:** 所有共享类型定义在 `packages/shared/src/types`，前后端统一导入

---

### 数据模型和类型定义

[Source: docs/architecture/data-models.md#user用户]

**User 类型：**

```typescript
interface User {
  id: string;
  username: string;
  email: string;
  password_hash: string;
  is_admin: boolean;
  created_at: Date;
}

interface UserPublic {
  id: string;
  username: string;
  email: string;
  is_admin: boolean;
  created_at: Date;
}
```

**前端列表展示类型（包含端点数量）：**

```typescript
interface UserListItem extends UserPublic {
  endpoint_count: number; // 用户拥有的端点数量
}
```

---

### API 规范

[Source: docs/architecture/api-specification.md]（根据现有实现推断）

**相关 API 端点：**

| Method | Path | Auth | Description |
|--------|------|------|-------------|
| GET | /api/admin/users | Yes (Admin) | 获取用户列表（包含端点数量） |
| GET | /api/endpoints?userId={userId} | Yes | 获取指定用户的端点列表（需确认） |

**获取用户列表 API 响应格式：**

成功响应：
```json
{
  "data": [
    {
      "id": "uuid",
      "username": "testuser",
      "email": "test@example.com",
      "is_admin": false,
      "created_at": "2025-10-29T10:00:00Z",
      "endpoint_count": 3
    }
  ]
}
```

**获取用户端点列表（需确认 API 是否存在）：**

如果不存在独立的"获取用户端点" API，可以复用现有的 `GET /api/endpoints` 并添加查询参数 `userId`：

```
GET /api/endpoints?userId={userId}
```

如果该 API 不存在，开发者需要在后端添加过滤逻辑（基于 `user_id` 过滤端点）。

---

### 多条件过滤实现细节

**过滤器 UI 推荐方案：**

使用 Ant Design 5.x 的 `Segmented` 组件（现代化分段控制器）：

```tsx
import { Segmented, Row, Col } from 'antd';

type RoleFilter = 'all' | 'admin' | 'user';
type EndpointCountFilter = 'all' | 'none' | 'any' | 'multiple';

const [roleFilter, setRoleFilter] = useState<RoleFilter>('all');
const [endpointCountFilter, setEndpointCountFilter] = useState<EndpointCountFilter>('all');

<Row gutter={[16, 16]}>
  <Col xs={24} sm={12} md={8}>
    <Segmented
      value={roleFilter}
      onChange={(value) => setRoleFilter(value as RoleFilter)}
      options={[
        { label: '全部', value: 'all' },
        { label: '管理员', value: 'admin' },
        { label: '普通用户', value: 'user' },
      ]}
      block
    />
  </Col>
  <Col xs={24} sm={12} md={8}>
    <Segmented
      value={endpointCountFilter}
      onChange={(value) => setEndpointCountFilter(value as EndpointCountFilter)}
      options={[
        { label: '全部', value: 'all' },
        { label: '无端点', value: 'none' },
        { label: '有端点', value: 'any' },
        { label: '多端点(≥3)', value: 'multiple' },
      ]}
      block
    />
  </Col>
</Row>
```

**过滤逻辑实现：**

```typescript
const getFilteredUsers = (): UserListItem[] => {
  let filtered = users;

  // 角色过滤
  if (roleFilter !== 'all') {
    filtered = filtered.filter((user) => {
      if (roleFilter === 'admin') return user.is_admin === true;
      if (roleFilter === 'user') return user.is_admin === false;
      return true;
    });
  }

  // 端点数量范围过滤
  if (endpointCountFilter !== 'all') {
    filtered = filtered.filter((user) => {
      switch (endpointCountFilter) {
        case 'none':
          return user.endpoint_count === 0;
        case 'any':
          return user.endpoint_count > 0;
        case 'multiple':
          return user.endpoint_count >= 3;
        default:
          return true;
      }
    });
  }

  // 搜索过滤
  if (searchQuery) {
    const lowerQuery = searchQuery.toLowerCase();
    filtered = filtered.filter((user) =>
      user.username.toLowerCase().includes(lowerQuery)
    );
  }

  return filtered;
};
```

---

### Drawer 实现细节

**Drawer 组件结构：**

```tsx
import { Drawer, Card, Descriptions, Table, Spin } from 'antd';

const [drawerVisible, setDrawerVisible] = useState<boolean>(false);
const [selectedUser, setSelectedUser] = useState<UserListItem | null>(null);
const [userEndpoints, setUserEndpoints] = useState<Endpoint[]>([]);
const [endpointsLoading, setEndpointsLoading] = useState<boolean>(false);

const handleViewUserEndpoints = (user: UserListItem) => {
  setSelectedUser(user);
  setDrawerVisible(true);
  void fetchUserEndpoints(user.id);
};

const fetchUserEndpoints = async (userId: string) => {
  try {
    setEndpointsLoading(true);
    // 假设 API: GET /api/endpoints?userId={userId}
    const data = await getEndpoints(userId); // 需确认 API 是否支持 userId 参数
    setUserEndpoints(data);
  } catch (error) {
    console.error('加载用户端点失败:', error);
    void message.error('加载用户端点失败');
  } finally {
    setEndpointsLoading(false);
  }
};

<Drawer
  title={`${selectedUser?.username || '用户'} 的端点列表`}
  placement="right"
  width={640}
  onClose={() => setDrawerVisible(false)}
  open={drawerVisible}
>
  {selectedUser && (
    <>
      <Card title="用户信息" style={{ marginBottom: '24px' }}>
        <Descriptions column={1}>
          <Descriptions.Item label="用户名">{selectedUser.username}</Descriptions.Item>
          <Descriptions.Item label="邮箱">{selectedUser.email}</Descriptions.Item>
          <Descriptions.Item label="角色">
            {selectedUser.is_admin ? '管理员' : '普通用户'}
          </Descriptions.Item>
          <Descriptions.Item label="注册时间">
            {formatDateTime(selectedUser.created_at)}
          </Descriptions.Item>
          <Descriptions.Item label="端点数量">
            {selectedUser.endpoint_count}
          </Descriptions.Item>
        </Descriptions>
      </Card>

      <div style={{ marginBottom: '16px', fontWeight: 'bold' }}>端点列表</div>

      {endpointsLoading ? (
        <Spin tip="加载中..." />
      ) : (
        <Table
          dataSource={userEndpoints}
          columns={endpointColumns} // 需定义端点列配置
          rowKey="id"
          pagination={{ pageSize: 5 }}
          locale={{ emptyText: '该用户暂无端点' }}
        />
      )}
    </>
  )}
</Drawer>
```

**端点列配置（Drawer 内表格）：**

```typescript
const endpointColumns: ColumnsType<Endpoint> = [
  {
    title: '端点名称',
    dataIndex: 'name',
    key: 'name',
  },
  {
    title: '端点 ID',
    dataIndex: 'endpoint_id',
    key: 'endpoint_id',
  },
  {
    title: '创建时间',
    dataIndex: 'created_at',
    key: 'created_at',
    render: (date: string) => formatDateTime(date),
  },
  {
    title: '最后活跃时间',
    dataIndex: 'last_active_at',
    key: 'last_active_at',
    render: (date: string | null) => (date ? formatDateTime(date) : '未活跃'),
  },
];
```

**关键说明：**

- Drawer 的 `width` 设置为 640px，适合展示详细信息
- 用户信息使用 Descriptions 组件，清晰展示键值对
- 端点列表使用独立的 Table 组件，分页大小设置为 5
- 需要确认后端 API 是否支持 `userId` 参数过滤端点，如果不支持，需要在后端添加过滤逻辑

---

### Popover 实现细节

**Popover 组件结构：**

```tsx
import { Popover, Descriptions, Typography } from 'antd';

const { Text } = Typography;

const renderUserPopover = (user: UserListItem) => {
  const content = (
    <div style={{ width: '300px' }}>
      <Descriptions column={1} size="small">
        <Descriptions.Item label="用户名">{user.username}</Descriptions.Item>
        <Descriptions.Item label="邮箱">{user.email}</Descriptions.Item>
        <Descriptions.Item label="角色">
          {user.is_admin ? '管理员' : '普通用户'}
        </Descriptions.Item>
        <Descriptions.Item label="注册时间">
          {formatDateTime(user.created_at)}
        </Descriptions.Item>
        <Descriptions.Item label="端点数量">{user.endpoint_count}</Descriptions.Item>
      </Descriptions>
    </div>
  );

  return (
    <Popover content={content} title="用户详情" trigger="hover">
      <Text style={{ cursor: 'pointer', color: '#1890ff' }}>{user.username}</Text>
    </Popover>
  );
};
```

**更新"用户名"列配置：**

```typescript
const columns: ColumnsType<UserListItem> = [
  {
    title: '用户名',
    dataIndex: 'username',
    key: 'username',
    render: (_text: unknown, record: UserListItem) => renderUserPopover(record),
    sorter: (a, b) => a.username.localeCompare(b.username),
  },
  // ... 其他列 ...
];
```

**关键说明：**

- Popover 内容宽度设置为 300px，避免内容过宽
- 使用 `trigger="hover"` 实现鼠标悬停显示
- 用户名文本设置为蓝色（`#1890ff`）和 `cursor: pointer`，提示可交互
- Popover 内容使用 Descriptions 组件，与 Drawer 保持一致

---

### 表格排序实现细节

**表格列配置更新：**

```typescript
const columns: ColumnsType<UserListItem> = [
  // ... 其他列 ...
  {
    title: '端点数量',
    dataIndex: 'endpoint_count',
    key: 'endpoint_count',
    sorter: (a, b) => a.endpoint_count - b.endpoint_count,
    render: (count: number, record: UserListItem) =>
      count > 0 ? (
        <Link onClick={() => handleViewUserEndpoints(record)}>{count}</Link>
      ) : (
        <Text type="secondary">0</Text>
      ),
  },
  {
    title: '注册时间',
    dataIndex: 'created_at',
    key: 'created_at',
    render: (date: string) => formatDateTime(date),
    sorter: (a, b) =>
      new Date(a.created_at).getTime() - new Date(b.created_at).getTime(),
    defaultSortOrder: 'descend', // 默认降序（最新用户在前）
  },
];
```

**关键说明：**

- `sorter` 属性接受比较函数 `(a, b) => number`
- 返回值：负数（a 在前）、0（相等）、正数（b 在前）
- `defaultSortOrder` 设置默认排序方向（`'ascend'` 或 `'descend'`）

---

### 响应式布局实现

**过滤器和搜索框布局：**

```tsx
import { Row, Col, Card } from 'antd';

<Card style={{ marginBottom: '24px' }}>
  <Row gutter={[16, 16]} align="middle">
    <Col xs={24} sm={12} md={8}>
      <Input.Search
        placeholder="搜索用户名"
        allowClear
        value={searchQuery}
        onChange={(e) => handleSearch(e.target.value)}
        style={{ width: '100%' }}
      />
    </Col>
    <Col xs={24} sm={12} md={8}>
      <div style={{ marginBottom: '8px', fontSize: '12px', color: '#666' }}>
        角色过滤
      </div>
      <Segmented
        value={roleFilter}
        onChange={(value) => setRoleFilter(value as RoleFilter)}
        options={[
          { label: '全部', value: 'all' },
          { label: '管理员', value: 'admin' },
          { label: '普通用户', value: 'user' },
        ]}
        block
      />
    </Col>
    <Col xs={24} sm={12} md={8}>
      <div style={{ marginBottom: '8px', fontSize: '12px', color: '#666' }}>
        端点数量范围
      </div>
      <Segmented
        value={endpointCountFilter}
        onChange={(value) => setEndpointCountFilter(value as EndpointCountFilter)}
        options={[
          { label: '全部', value: 'all' },
          { label: '无端点', value: 'none' },
          { label: '有端点', value: 'any' },
          { label: '多端点', value: 'multiple' },
        ]}
        block
      />
    </Col>
  </Row>
</Card>
```

**响应式断点说明：** [Source: Ant Design Grid 文档]

- `xs={24}`: 移动端（<576px）占满整行
- `sm={12}`: 平板端（≥576px）占一半宽度
- `md={8}`: 桌面端（≥768px）每个占 1/3 宽度

---

### 编码规范和命名约定

[Source: docs/architecture/coding-standards.md#naming-conventions]

| 元素 | 规范 | 示例 |
|------|------|------|
| Components | PascalCase | `UsersPage.tsx` |
| Functions | camelCase | `handleViewUserEndpoints()`, `getFilteredUsers()` |
| Constants | UPPER_SNAKE_CASE | `MAX_USERS` |
| Type Definitions | PascalCase | `RoleFilter`, `EndpointCountFilter` |

**关键规范：**

- 使用 `async/await` 处理异步操作（不使用 Promise.then）
- 错误处理使用 `try/catch` 块
- 所有函数必须有 JSDoc 注释（描述功能、参数、返回值）
- 使用 `void` 操作符处理不需要 await 的 Promise（如 `void message.success(...)`）

---

### 样式美化实现指南

**Ant Design 5.x 样式系统：** [Source: docs/architecture/tech-stack.md#css-framework]

Ant Design 5.x 使用 CSS-in-JS 方案（`@ant-design/cssinjs`），支持 Design Token 和主题定制。

**推荐的样式实现方式：**

1. **内联样式（简单样式）：**
   ```tsx
   <div style={{ padding: '24px', background: '#f5f5f5' }}>...</div>
   ```

2. **Ant Design 组件属性（推荐）：**
   ```tsx
   <Card
     bordered={false}
     style={{ borderRadius: '8px', boxShadow: '0 2px 8px rgba(0,0,0,0.1)' }}
   />
   ```

**常用样式模式：**

**1. 页面容器样式：**
```tsx
<div style={{
  minHeight: 'calc(100vh - 64px)',
  background: '#f5f5f5',
  padding: '24px',
}}>
  <div style={{
    maxWidth: '1400px',
    margin: '0 auto',
  }}>
    {/* 页面内容 */}
  </div>
</div>
```

**2. 卡片容器样式：**
```tsx
<Card
  style={{
    borderRadius: '12px',
    background: '#fff',
    boxShadow: '0 2px 8px rgba(0,0,0,0.08)',
    marginBottom: '24px',
  }}
>
  {/* 卡片内容 */}
</Card>
```

**3. 表格样式美化：**
```tsx
<Table
  dataSource={getFilteredUsers()}
  columns={columns}
  rowKey="id"
  style={{
    background: '#fff',
    borderRadius: '12px',
    overflow: 'hidden',
  }}
  pagination={{
    pageSize: 10,
    showSizeChanger: true,
    showTotal: (total) => `共 ${total} 个用户`,
  }}
/>
```

---

## Testing

**测试策略：** 手动测试

**测试范围：**

1. ✅ 多条件过滤功能（角色过滤 + 端点数量范围过滤）
2. ✅ 端点数量 Drawer 展开和关闭
3. ✅ 用户详情 Popover 悬停显示
4. ✅ 表格排序（注册时间、端点数量）
5. ✅ 搜索和过滤的组合效果
6. ✅ 响应式布局在不同屏幕尺寸下的表现
7. ✅ 回归测试：现有功能不受影响

**测试环境：**

- 桌面浏览器（Chrome、Firefox、Safari）
- 移动端模拟器（Chrome DevTools 响应式模式）

---

## Change Log

| Date       | Version | Description              | Author             |
|------------|---------|---------------------------|--------------------|
| 2025-10-29 | 1.0     | 初始创建故事 5.3          | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used

_待开发代理填写_

### Debug Log References

_待开发代理填写_

### Completion Notes List

_待开发代理填写_

### File List

_待开发代理填写_

## QA Results

_待 QA 代理填写_
